;DEFINIMOS LAS PLANTILLAS PARA LA CESAREA

;para la cesaria
(deftemplate cesarea
(slot codigo_paciente)
(slot tipo)			;prevista;improvisada;
)

;para el bebe
(deftemplate bebe
(slot codigo_paciente)
(slot posicion)			;podalica
(slot cabeza_grande)	;si
(slot ritmo_cardiaco)	;no_es_regular
(slot explusar_meconio) ;si
)

;para la madre
(deftemplate madre
(slot codigo_paciente)
(slot enfermedad)			;gestosisi ;diabetes_gravidica
(slot problema)				;corazon, renales, graves_infecciones_vias_genitales
)

;para la placenta
(deftemplate placenta
(slot codigo_paciente)
(slot posicion)			;previa_central
(slot estado)		;desprendida
)

;para la incision
(deftemplate incision
(slot codigo_paciente)
(slot tipo) ;verticl ;horizontal
(slot cicatriz) ; visible ;no_visible
(slot cesarea)	;improvisada ;prevista
)

;HECHOS
(deffacts hechos_iniciales
	;Para las cesareas previstas
	(bebe (codigo_paciente p001)(posicion podalica) (cabeza_grande no)(ritmo_cardiaco regular) (explusar_meconio no))
	(madre (codigo_paciente p001)(enfermedad diabetes)(problema corazon))
	(placenta (codigo_paciente p001)(posicion previa_central)(estado no_desprendida))

	(bebe (codigo_paciente p003)(posicion podalica) (cabeza_grande no)(ritmo_cardiaco regular) (explusar_meconio no))
	(madre (codigo_paciente p003)(enfermedad gestosisi)(problema renales))
	(placenta (codigo_paciente p003)(posicion previa_central)(estado no_desprendida))

	;Para las cesareas improvisada
	(cesarea (codigo_paciente p002)(tipo improvisada))
	(bebe (codigo_paciente p002)(posicion normal) (cabeza_grande si)(ritmo_cardiaco no_regular) (explusar_meconio si))
	(placenta (codigo_paciente p002)(posicion previa_horizontal)(estado desprendida))

	;Tipos de incision
	;Umbilico pubico
	(incision (codigo_paciente p002)(tipo vertical)(cicatriz visible)(cesarea improvisada))
	(placenta (codigo_paciente p002)(posicion previa_horizontal)(estado desprendida))

	;Transversal baja
	(incision (codigo_paciente p001)(tipo horizontal)(cicatriz no_visible)(cesarea prevista))

	;Joel Coell
	(incision (codigo_paciente p003)(tipo horizontal)(cicatriz visible)(cesarea prevista))
)

;REGLAS

(defrule prevista
(bebe (codigo_paciente ?p1)(posicion podalica) (cabeza_grande no)(ritmo_cardiaco regular) (explusar_meconio no))
(or (madre (codigo_paciente ?p1)(enfermedad gestosisi)) (madre (codigo_paciente ?p1)(enfermedad diabetes)))
(placenta (codigo_paciente ?p1)(posicion previa_central)(estado no_desprendida))
(or (madre (codigo_paciente ?p1)(problema corazon)) (madre (codigo_paciente ?p1)(problema renales)) (madre (codigo_paciente ?p1)(problema infecciones_vias_genitales)))
=> 
(assert(cesarea (codigo_paciente ?p1) (tipo prevista))) ;agregamos un paciente de cesarea prevista
(printout t "El paciente " ?p1 "  tendra una cesarea PREVISTA  " crlf)
)

(defrule improvisada
(cesarea (codigo_paciente ?p1)(tipo improvisada))
(bebe (codigo_paciente ?p1)(posicion normal) (cabeza_grande si)(ritmo_cardiaco no_regular) (explusar_meconio si))
(placenta (codigo_paciente ?p1)(posicion previa_horizontal)(estado desprendida))
=> 
(assert(cesarea (codigo_paciente ?p1) (tipo improvisada))) ;agregamos un paciente de cesarea improvisada
(printout t "El paciente " ?p1 "  tendra una cesarea IMPROVISADA  " crlf)
)

;tipos de incision

(defrule incision_umbilico_pubica
(incision (codigo_paciente ?p1)(tipo vertical)(cicatriz visible)(cesarea improvisada))
(placenta (codigo_paciente ?p1)(estado desprendida))
=>
(printout t "El paciente " ?p1 "  tendra una incision de tipo UMBILICO PUBICA  " crlf)
)

(defrule incision_transversal
(incision (codigo_paciente ?p1)(tipo horizontal)(cicatriz no_visible)(cesarea prevista))

=>
(printout t "El paciente " ?p1 "  tendra una incision de tipo TRANSVERSAL BAJA " crlf)
)

(defrule incision_joel_coell
(incision (codigo_paciente ?p1)(tipo horizontal)(cesarea prevista))
=>
(printout t "El paciente " ?p1 "  tendra una incision de tipo JOEL COELL " crlf)
)

